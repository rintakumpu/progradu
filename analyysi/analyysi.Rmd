---
title: "Hiukassuodin- ja hiukassiloitinalgoritmit sekä niiden soveltaminen AoA-menetelmään perustuvassa Bluetooth-sisätilapaikannuksessa / Analyysi"
author: "Lasse Rintakumpu"
date: '`r Sys.Date()`'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Ladataan tarvittavat kirjastot
library(truncnorm)
```

```{r}
# Ladataan data
testipolku <- read_csv("data/test_path.csv")
polygonit_F <- read_csv("data/inclusion_polygons.csv")
polygonit_E <- read_csv("data/exclusion_polygons.csv")
y <- read_csv("data/y.csv")
```

```{r}
# Asetetaan muuttujia
r <- 30

# Ajetaan paikannus
pf_positioning(y, exclusion_polygons = polygonit_E,
               inclusion_polygons = polygonit_F,
               N = 1000,
                                resampling = 0,
                                map_matching = F, q = 2.5,
                                smoothing = F, rssi_threshold = -120,
                                P = 0)
```

## Vaihe 1

Ensimmäisessä vaiheessa tarkastelaan partikkelien määrän $N={100,1000,10000}$ sekä uudelleenotannan kynnysarvon $resampling={0,1/10,2/3,1}$ vaikutusta paikannuskeskivirheeseen. Karttasovitusalgoritmia ei käytetä, kuten ei myöskään prediktiivistä siloitinta eikä signaalin vahvuuden kynnysarvoa. Dynaamisen mallin kohina-arvo $q=2.5$ pidettiin vakiona. Ensimmäisessä vaiheessa tarkasteltiin siis $12$ eri suunnitteluparametrikombinaatiota.

```{r}
N_values <- c(100,1000,10000)
resampling_values <- c(0,1/10,2/3,1)
phase1_values <- expand.grid(N=N_values, resampling=resampling_values)
phase1_results <- list()

for(i in 1:nrow(phase1_values)) {
  set.seed(2666)
  phase1_runs <- list()
  for(j in 1:30) {
   phase1_runs[[j]] <- pf_positioning(y, N = phase1_values$N[i],
                                resampling = phase1_values$resampling[i],
                                exclusion_polygons = polygonit_E,
                                inclusion_polygons = polygonit_F,
                                map_matching = F, q = 2.5,
                                smoothing = F, rssi_threshold = -120,
                                P = 0)
  }
  phase1_results[[i]] <- phase1_runs
}
```



